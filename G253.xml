<?xml version="1.0" encoding="utf-8"?>
<Metacode xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="C:\Program Files (x86)\Tecnomatix\MachineConfigurator\resource\mc_metacode.xsd">
  <Name>G253</Name>
  <Variable>LV_vecTool</Variable>
  <Variable>LV_vecDisplacement</Variable>
  <Variable>LV_matLocal</Variable>
  <Variable>LV_structRotSol</Variable>
  <Execute>
    <AssignCommand>
      <Variable>LV_matLocal</Variable>
      <Value>getTrafoMatrix("ROTATIONAL")</Value>
    </AssignCommand>
    <AssignCommand>
      <Variable>LV_vecTool</Variable>
      <Value>multiplyRotMatrixByVector(LV_matLocal,createVector(0,0,1)) </Value>
    </AssignCommand>
    <AssignCommand>
      <Variable>LV_structRotSol</Variable>
      <Value>calculateIKSAngles(GV_strSwivelingChainName,LV_vecTool) </Value>
    </AssignCommand>
    <AssignCommand>
      <Variable>LV_vecDisplacement</Variable>
      <Value>calculateIKSLinears(GV_strSwivelingChainName,createCoordinate(),getStructField(LV_structRotSol,"dPartAngle1"),getStructField(LV_structRotSol,"dToolAngle1"))</Value>
    </AssignCommand>
    <MacroCommand>
      <Name>GMe_SetJointValueRotational</Name>
      <Param>getStructField(LV_structRotSol,"strPartRotaryAxis")</Param>
      <Param>getStructField(LV_structRotSol,"dPartAngle1")</Param>
    </MacroCommand>
    <MacroCommand>
      <Name>GMe_SetJointValueRotational</Name>
      <Param>getStructField(LV_structRotSol,"strToolRotaryAxis")</Param>
      <Param>getStructField(LV_structRotSol,"dToolAngle1")</Param>
    </MacroCommand>
    <Command>
      <Name>ActivateTransformation</Name>
      <Param>"TOOLROTATE"</Param>
      <Param>FALSE</Param>
      <Param>FALSE</Param>
    </Command>
    <Command>
      <Name>ResetTransformation</Name>
      <Param>"TOOLROTATE"</Param>
    </Command>
    <Command>
      <Name>DisplaceOrigin</Name>
      <Param>"TOOLROTATE"</Param>
      <Param>TRUE</Param>
      <Param>getFirstGeoAxis()</Param>
      <Param>getVectorX(LV_vecDisplacement)</Param>
    </Command>
    <Command>
      <Name>DisplaceOrigin</Name>
      <Param>"TOOLROTATE"</Param>
      <Param>TRUE</Param>
      <Param>getSecondGeoAxis()</Param>
      <Param>getVectorY(LV_vecDisplacement)</Param>
    </Command>
    <Command>
      <Name>DisplaceOrigin</Name>
      <Param>"TOOLROTATE"</Param>
      <Param>TRUE</Param>
      <Param>getThirdGeoAxis()</Param>
      <Param>getVectorZ(LV_vecDisplacement)</Param>
    </Command>
    <Command>
      <Name>ActivateTransformation</Name>
      <Param>"TOOLROTATE"</Param>
      <Param>TRUE</Param>
      <Param>TRUE</Param>
    </Command>
  </Execute>
</Metacode>