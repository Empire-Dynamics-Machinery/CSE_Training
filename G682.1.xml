<?xml version="1.0" encoding="utf-8"?>
<Metacode xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="C:\Program Files (x86)\Tecnomatix\MachineConfigurator\resource\mc_metacode.xsd">
  <Name>G682.1</Name>
  <MCParam>X</MCParam>
  <MCParam>Y</MCParam>
  <MCParam>Z</MCParam>
  <MCParam>I</MCParam>
  <MCParam>J</MCParam>
  <MCParam>K</MCParam>
  <Variable>LV_strTrafoName</Variable>
  <Variable>LV_matLocal</Variable>
  <Variable>LV_vecTrans</Variable>
  <Execute>
    <AssignCommand>
      <Variable>LV_strTrafoName</Variable>
      <Value>"ROTATIONAL"</Value>
    </AssignCommand>
    <Comment>initialize a vector (0,0,0)</Comment>
    <AssignCommand>
      <Variable>LV_vecTrans</Variable>
      <Value>createVector()</Value>
    </AssignCommand>
    <Command>
      <Name>ActivateTransformation</Name>
      <Param>LV_strTrafoName</Param>
      <Param>FALSE</Param>
      <Param>FALSE</Param>
    </Command>
    <Command>
      <Name>ResetTransformation</Name>
      <Param>LV_strTrafoName</Param>
    </Command>
    <IfCommand>
      <Condition>isDefined(X)</Condition>
      <Then>
        <Command>
          <Name>SetVectorX</Name>
          <Param>LV_vecTrans</Param>
          <Param>X*25.4</Param>
        </Command>
      </Then>
    </IfCommand>
    <IfCommand>
      <Condition>isDefined(Y)</Condition>
      <Then>
        <Command>
          <Name>SetVectorY</Name>
          <Param>LV_vecTrans</Param>
          <Param>Y*25.4</Param>
        </Command>
      </Then>
    </IfCommand>
    <IfCommand>
      <Condition>isDefined(Z)</Condition>
      <Then>
        <Command>
          <Name>SetVectorZ</Name>
          <Param>LV_vecTrans</Param>
          <Param>Z*25.4</Param>
        </Command>
      </Then>
    </IfCommand>
    <Command>
      <Name>Assert</Name>
      <Param>isDefined(I) AND isDefined(J) AND isDefined(K)</Param>
      <Param>"fatal"</Param>
      <Param>"G682 should be specified with I, J, and K!"</Param>
    </Command>
    <AssignCommand>
      <Variable>LV_matLocal</Variable>
      <Value>calculateRotMatrix(getRadians(K),getRadians(J),getRadians(I),"euler")</Value>
    </AssignCommand>
    <Command>
      <Name>TranslateMatrix</Name>
      <Param>LV_matLocal</Param>
      <Param>LV_vecTrans</Param>
    </Command>
    <Command>
      <Name>SetTrafoMatrix</Name>
      <Param>"ROTATIONAL"</Param>
      <Param>LV_matLocal</Param>
    </Command>
    <Command>
      <Name>ActivateTransformation</Name>
      <Param>LV_strTrafoName</Param>
      <Param>TRUE</Param>
      <Param>TRUE</Param>
    </Command>
  </Execute>
</Metacode>